<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Book Exchange Box</title>
</head>
<body>
<h1>Book Exchange Box</h1>

<!-- Search form -->
<h2>Search Books</h2>
<form id="searchForm">
    <label for="searchTitle">Search by Title:</label>
    <input type="text" id="searchTitle" name="title">
    <button type="submit">Search</button>
</form>
<form id="searchFormAuthor">
    <label for="searchAuthor">Search by Author:</label>
    <input type="text" id="searchAuthor" name="title">
    <button type="submit">Search</button>
</form>
<form id="searchFormBox">
    <label for="searchBox">Search by Book Box:</label>
    <input type="text" id="searchBox" name="title">
    <button type="submit">Search</button>
</form>
<ul id="searchResults"></ul>

<!-- Add book form -->
<h2>Add New Book</h2>
<form id="addForm">
    <label for="addTitle">Title:</label>
    <input type="text" id="addTitle" name="title" required><br>
    <label for="addAuthor">Author:</label>
    <input type="text" id="addAuthor" name="author" required><br>
    <label for="addBookBox">Book Box:</label>
    <input type="text" id="addBookBox" name="bookBox" required><br>
    <button type="submit">Add Book</button>
</form>

<!-- Delete book form -->
<h2>Delete Book</h2>
<form id="deleteForm">
    <label for="deleteTitle">Title:</label>
    <input type="text" id="deleteTitle" name="title" required><br>
    <label for="deleteAuthor">Author:</label>
    <input type="text" id="deleteAuthor" name="author" required><br>
    <label for="deleteBookBox">Book Box:</label>
    <input type="text" id="deleteBookBox" name="bookBox" required><br>
    <button type="submit">Delete Book</button>
</form>

<script>
    // Base URL of your Express.js server
    const baseURL = 'http://localhost:3001';
    console.log(baseURL)

    // Search form submission handler
    document.getElementById('searchForm').addEventListener('submit', async (event) => {
        event.preventDefault();
        const searchTitle = document.getElementById('searchTitle').value;
        const response = await fetch(`${baseURL}/api/search?title=${encodeURIComponent(searchTitle)}`);
        const data = await response.json();
        displaySearchResults(data);
    });

    // Search form submission handler for author
    document.getElementById('searchFormAuthor').addEventListener('submit', async (event) => {
        event.preventDefault();
        const searchAuthor = document.getElementById('searchAuthor').value;
        const response = await fetch(`${baseURL}/api/search?author=${encodeURIComponent(searchAuthor)}`);
        const data = await response.json();
        displaySearchResults(data);
    });

    document.getElementById('searchFormBox').addEventListener('submit', async (event) => {
        event.preventDefault();
        const searchBox = document.getElementById('searchBox').value;
        const response = await fetch(`${baseURL}/api/search?bookBox=${encodeURIComponent(searchBox)}`);
        const data = await response.json();
        displaySearchResults(data);
    });

    // Function to display search results
    function displaySearchResults(data) {
        const searchResults = document.getElementById('searchResults');
        searchResults.innerHTML = '';
        data.forEach(book => {
            const li = document.createElement('li');
            const title = document.createElement('strong');
            title.textContent = `Title: ${book['Title of the Book']}`;
            li.appendChild(title);

            if (book['Name of the First Author or Publisher']) {
                const author1 = document.createElement('p');
                author1.textContent = `First Author or Publisher: ${book['Name of the First Author or Publisher']}`;
                li.appendChild(author1);
            }

            if (book['Name of the Second Author (optional)']) {
                const author2 = document.createElement('p');
                author2.textContent = `Second Author: ${book['Name of the Second Author (optional)']}`;
                li.appendChild(author2);
            }

            if (book['Name of the Third Author (optional)']) {
                const author3 = document.createElement('p');
                author3.textContent = `Third Author: ${book['Name of the Third Author (optional)']}`;
                li.appendChild(author3);
            }

            if (book['Name of the Fourth Author (optional)']) {
                const author4 = document.createElement('p');
                author4.textContent = `Fourth Author: ${book['Name of the Fourth Author (optional)']}`;
                li.appendChild(author4);
            }

            if (book['Name of the Fifth Author (optional)']) {
                const author5 = document.createElement('p');
                author5.textContent = `Fifth Author: ${book['Name of the Fifth Author (optional)']}`;
                li.appendChild(author5);
            }

            if (book['Name of the Sixth Author (optional)']) {
                const author6 = document.createElement('p');
                author6.textContent = `Sixth Author: ${book['Name of the Sixth Author (optional)']}`;
                li.appendChild(author6);
            }

            if (book['Name of the Seventh Author (optional)']) {
                const author7 = document.createElement('p');
                author7.textContent = `Seventh Author: ${book['Name of the Seventh Author (optional)']}`;
                li.appendChild(author7);
            }

            const bookBox = document.createElement('p');
            bookBox.textContent = `Book Box: ${book['Address of the Book Box']}`;
            li.appendChild(bookBox);

            searchResults.appendChild(li);
        });
    }

    // Add book form submission handler
    document.getElementById('addForm').addEventListener('submit', async (event) => {
        event.preventDefault();
        const addTitle = document.getElementById('addTitle').value;
        const addAuthor = document.getElementById('addAuthor').value;
        const addBookBox = document.getElementById('addBookBox').value;
        const requestBody = {
            "Title of the Book": addTitle,
            "Name of the First Author or Publisher": addAuthor,
            "Address of the Book Box": addBookBox,
        };
        const response = await fetch(`${baseURL}/api/add`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(requestBody)
        });
        const data = await response.json();
        console.log(data);
    });

    // Delete book form submission handler
    document.getElementById('deleteForm').addEventListener('submit', async (event) => {
        event.preventDefault();
        const deleteTitle = document.getElementById('deleteTitle').value;
        const deleteAuthor = document.getElementById('deleteAuthor').value;
        const deleteBookBox = document.getElementById('deleteBookBox').value;
        const requestBody = {
            "Title of the Book": deleteTitle,
            "Name of the First Author or Publisher": deleteAuthor,
            "Address of the Book Box": deleteBookBox,
        };
        const response = await fetch(`${baseURL}/api/delete`, {
            method: 'DELETE',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(requestBody)
        });
        const data = await response.json();
        console.log(data);
    });
</script>
<script src="search function.js"></script>

</body>
</html>
